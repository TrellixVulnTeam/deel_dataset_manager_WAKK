<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>deel.datasets.utils package &mdash; DEEL Dataset Manager 0.0.7 documentation</title>
      <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="deel.datasets.providers package" href="deel.datasets.providers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> DEEL Dataset Manager
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#configuration-example">Configuration Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="plugins.html#extending-the-dataset-class">Extending the <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html#utility-functions">Utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html#packaging-the-dataset-s">Packaging the dataset(s)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cli.html#listing-datasets">Listing datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#downloading-datasets">Downloading datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#removing-datasets">Removing datasets</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="deel.datasets.html">deel.datasets package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="deel.datasets.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="deel.datasets.providers.html">deel.datasets.providers package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deel.datasets.providers.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="deel.datasets.providers.html#module-deel.datasets.providers.exceptions">deel.datasets.providers.exceptions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="deel.datasets.providers.html#module-deel.datasets.providers.ftp_providers">deel.datasets.providers.ftp_providers module</a></li>
<li class="toctree-l4"><a class="reference internal" href="deel.datasets.providers.html#module-deel.datasets.providers.gcloud_provider">deel.datasets.providers.gcloud_provider module</a></li>
<li class="toctree-l4"><a class="reference internal" href="deel.datasets.providers.html#module-deel.datasets.providers.http_providers">deel.datasets.providers.http_providers module</a></li>
<li class="toctree-l4"><a class="reference internal" href="deel.datasets.providers.html#module-deel.datasets.providers.local_as_provider">deel.datasets.providers.local_as_provider module</a></li>
<li class="toctree-l4"><a class="reference internal" href="deel.datasets.providers.html#module-deel.datasets.providers.local_provider">deel.datasets.providers.local_provider module</a></li>
<li class="toctree-l4"><a class="reference internal" href="deel.datasets.providers.html#module-deel.datasets.providers.provider">deel.datasets.providers.provider module</a></li>
<li class="toctree-l4"><a class="reference internal" href="deel.datasets.providers.html#module-deel.datasets.providers.remote_provider">deel.datasets.providers.remote_provider module</a></li>
<li class="toctree-l4"><a class="reference internal" href="deel.datasets.providers.html#module-deel.datasets.providers.webdav_provider">deel.datasets.providers.webdav_provider module</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">deel.datasets.utils package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-deel.datasets.utils.numpy_utils">deel.datasets.utils.numpy_utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-deel.datasets.utils.supervised">deel.datasets.utils.supervised module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-deel.datasets.utils.tensorflow_utils">deel.datasets.utils.tensorflow_utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-deel.datasets.utils.torch_utils">deel.datasets.utils.torch_utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-deel.datasets.utils.unsupervised">deel.datasets.utils.unsupervised module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deel.datasets.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="deel.datasets.html#module-deel.datasets.dataset">deel.datasets.dataset module</a></li>
<li class="toctree-l2"><a class="reference internal" href="deel.datasets.html#module-deel.datasets.settings">deel.datasets.settings module</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DEEL Dataset Manager</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="deel.datasets.html">deel.datasets package</a> &raquo;</li>
      <li>deel.datasets.utils package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/deel.datasets.utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-deel.datasets.utils">
<span id="deel-datasets-utils-package"></span><h1>deel.datasets.utils package<a class="headerlink" href="#module-deel.datasets.utils" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-deel.datasets.utils.numpy_utils">
<span id="deel-datasets-utils-numpy-utils-module"></span><h2>deel.datasets.utils.numpy_utils module<a class="headerlink" href="#module-deel.datasets.utils.numpy_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.numpy_utils.numpy_split_on_label">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.numpy_utils.</span></span><span class="sig-name descname"><span class="pre">numpy_split_on_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.numpy_utils.numpy_split_on_label" title="Permalink to this definition"></a></dt>
<dd><p>Allows to split a numpy dataset in in-dataset and out-dataset according to labels_in
:type dataset: <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]
:param dataset: a numpy dataset
:type labels_in: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]
:param labels_in: array of ‘normal’ labels</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple of split datasets (dataset_in, dataset_out),</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deel.datasets.utils.supervised">
<span id="deel-datasets-utils-supervised-module"></span><h2>deel.datasets.utils.supervised module<a class="headerlink" href="#module-deel.datasets.utils.supervised" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.supervised.load_hierarchical_python_image_dataset">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.supervised.</span></span><span class="sig-name descname"><span class="pre">load_hierarchical_python_image_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispatch_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.supervised.load_hierarchical_python_image_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Walk the given folder applying the given function to
find to which dataset and class each file should be associated
to.</p>
<p>The function should returns a list of parts and a class. The number of
parts can be different for each file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – The folder to look for file.</p></li>
<li><p><strong>dispatch_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]]) – A function that should return a 2-tuple where
the first element in a list of str to represent the
dataset (e.g, <cite>[“train”, “a”]</cite>) to represent the dataset
<cite>train/a</cite> and the second element is the class of the file.</p></li>
<li><p><strong>unique_labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If <cite>True</cite>, the labels will be unique across all
datasets, otherwise the labels will go from 0 to the number
of class in the datasets - 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary mapping dataset hierarchy to 3-tuples <cite>(paths, labels, classes)</cite>
where <cite>paths</cite> is a list of paths, <cite>labels</cite> is a list of labels (integers) and
classes is a dictionary from labels to names.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Let assume the folder contains image under <cite>$class/train/</cite> and
<cite>$class/test</cite>, where <cite>$class</cite> is a class name. We could have
<cite>dispatch_fn</cite> returns either <cite>[“train”], $class</cite> or <cite>[“test”], $class</cite>
which would result in creating two distinct datasets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.supervised.load_hierarchical_pytorch_image_dataset">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.supervised.</span></span><span class="sig-name descname"><span class="pre">load_hierarchical_pytorch_image_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispatch_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.supervised.load_hierarchical_pytorch_image_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Creates a pytorch image dataset from the given folder and
parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – The folder containing the dataset. The folder should contain,
for each classes, a subfolder with only images inside.</p></li>
<li><p><strong>dispatch_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]]) – A function that should return a 2-tuple where
the first element in a list of str to represent the
dataset (e.g, <cite>[“train”, “a”]</cite>) to represent the dataset
<cite>train/a</cite> and the second element is the class of the file.</p></li>
<li><p><strong>image_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – The size of the image, or None to not resize images.</p></li>
<li><p><strong>unique_labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If <cite>True</cite>, the labels will be unique across all
datasets, otherwise the labels will go from 0 to the number
of class in the datasets - 1.</p></li>
<li><p><strong>transform</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code>]]) – Transformation to apply to the image before the conversion
to a torch tensor via <cite>ToTensor()</cite>. If <cite>image_size</cite> is not None, the
resize transform will be applied before these, if you want to do the
opposite, simply pass <cite>None</cite> as <cite>image_size</cite> and add the resize
transformation manually.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A two-tuple whose first element is another tuple containing two or three
datasets corresponding to training, validation and testing dataset, and the
second element is mapping from class labels to class names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.supervised.load_numpy_image_dataset">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.supervised.</span></span><span class="sig-name descname"><span class="pre">load_numpy_image_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_split=0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.supervised.load_numpy_image_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Creates a numpy image dataset from the given folder and
parameters.</p>
<p>The image dataset are 4-dimensional (N, H, W, C) numpy array where (H, W)
is the image size, C the number of channels. The arrays contain <cite>np.uint8</cite>
values between 0 and 255.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – The folder containing the dataset. The folder should contain,
for each classes, a subfolder with only images inside.</p></li>
<li><p><strong>image_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – The size of the image, or None to not resize images. <cite>None</cite>
is only supported if all the images already have the same size.</p></li>
<li><p><strong>train_split</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – One or two float values. If a single value is specified,
two datasets will be returned, one for training (using a percentage
<cite>train_split</cite> of data) and one for testing. If two values are specified,
three datasets will be returned: a training dataset, a validation
dataset and a testing dataset.</p></li>
<li><p><strong>shuffle</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – If True, shuffle images before spliting with the default seed.
If an int is given, use it as the seed for shuffling. If False, do not
shuffle.
False otherwise.</p></li>
<li><p><strong>aggregate_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Callable to aggregate classes. The function should take
the name of an original class (subfolder) and returns the name of the
“parent” class. If the call returns <cite>None</cite>, the class is discarded.</p></li>
<li><p><strong>filter_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – A function to filter out images. This function should take
a string (name of the file) and a path to the file and returns True
if the image should be included, False if it should be excluded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A two-tuple whose first element is another tuple containing two or three
2-tuple of numpy arrays corresponding to training, validation and testing
dataset, and the second element is mapping from class labels to class names.
Each dataset is a 2-tuple (x, y) where <cite>x</cite> is a 4-dimensional numpy array
containing images and <cite>y</cite> a one-dimensional numpy array containing classes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.supervised.load_python_image_dataset">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.supervised.</span></span><span class="sig-name descname"><span class="pre">load_python_image_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.supervised.load_python_image_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Load a python “dataset” from the given folder. This methods
returns a list of paths, labels, and class names from the given folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – The folder containing the dataset. The folder should contain,
for each class, a subfolder with only images inside.</p></li>
<li><p><strong>shuffle</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – If True, shuffle images with the default seed. If an int is given,
use it as the seed for shuffling. If False, do not shuffle. Shuffle is done
using the standard <cite>random.shuffle</cite> module
False otherwise.</p></li>
<li><p><strong>aggregate_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Callable to aggregate classes. The function should take
the name of an original class (subfolder) and returns the name of the
“parent” class. If the call returns <cite>None</cite>, the class is discarded.</p></li>
<li><p><strong>filter_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – A function to filter out images. This function should take
a string (name of the file) and a path to the file and returns True
if the image should be included, False if it should be excluded.</p></li>
</ul>
</dd>
</dl>
<p>Returns: A 3-tuple <cite>(paths, labels, classes)</cite> where <cite>paths</cite> is a list of
paths, <cite>labels</cite> is a list of labels (integers) and classes is a dictionary
from labels to names.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.supervised.load_pytorch_image_dataset">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.supervised.</span></span><span class="sig-name descname"><span class="pre">load_pytorch_image_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_split=0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.supervised.load_pytorch_image_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Creates a pytorch image dataset from the given folder and
parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – The folder containing the dataset. The folder should contain,
for each classes, a subfolder with only images inside.</p></li>
<li><p><strong>image_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – The size of the image, or None to not resize images.</p></li>
<li><p><strong>train_split</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – One or two float values. If a single value is specified,
two datasets will be returned, one for training (using a percentage
<cite>train_split</cite> of data) and one for testing. If two values are specified,
three datasets will be returned: a training dataset, a validation
dataset and a testing dataset.</p></li>
<li><p><strong>shuffle</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – If True, shuffle images before spliting with the default seed.
If an int is given, use it as the seed for shuffling. If False, do not
shuffle.</p></li>
<li><p><strong>aggregate_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Callable to aggregate classes. The function should take
the name of an original class (subfolder) and returns the name of the
“parent” class. If the call returns <cite>None</cite>, the class is discarded.</p></li>
<li><p><strong>filter_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – A function to filter out images. This function should take
a string (name of the file) and a path to the file and returns True
if the image should be included, False if it should be excluded.</p></li>
<li><p><strong>transform</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code>]]) – Transformation to apply to the image before the conversion
to a torch tensor via <cite>ToTensor()</cite>. If <cite>image_size</cite> is not None, the
resize transform will be applied before these, if you want to do the
opposite, simply pass <cite>None</cite> as <cite>image_size</cite> and add the resize
transformation manually.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A two-tuple whose first element is another tuple containing two or three
datasets corresponding to training, validation and testing dataset, and the
second element is mapping from class labels to class names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.supervised.load_tensorflow_image_dataset">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.supervised.</span></span><span class="sig-name descname"><span class="pre">load_tensorflow_image_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_split=0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.supervised.load_tensorflow_image_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Creates a tensorflow image dataset from the given folder and
parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – The folder containing the dataset. The folder should contain,
for each classes, a subfolder with only images inside.</p></li>
<li><p><strong>image_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – The size of the image, or None to not resize images.</p></li>
<li><p><strong>train_split</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – One or two float values. If a single value is specified,
two datasets will be returned, one for training (using a percentage
<cite>train_split</cite> of data) and one for testing. If two values are specified,
three datasets will be returned: a training dataset, a validation
dataset and a testing dataset.</p></li>
<li><p><strong>shuffle</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – If True, shuffle images before spliting with the default seed.
If an int is given, use it as the seed for shuffling. If False, do not
shuffle.
False otherwise.</p></li>
<li><p><strong>aggregate_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Callable to aggregate classes. The function should take
the name of an original class (subfolder) and returns the name of the
“parent” class. If the call returns <cite>None</cite>, the class is discarded.</p></li>
<li><p><strong>filter_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – A function to filter out images. This function should take
a string (name of the file) and a path to the file and returns True
if the image should be included, False if it should be excluded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A two-tuple whose first element is another tuple containing two or three
datasets corresponding to training, validation and testing dataset, and the
second element is mapping from class labels to class names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.supervised.split_datasets_on_label">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.supervised.</span></span><span class="sig-name descname"><span class="pre">split_datasets_on_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.supervised.split_datasets_on_label" title="Permalink to this definition"></a></dt>
<dd><p>Allows to split a list of datasets in in-dataset and out-dataset
according to the given labels.
See <cite>split_on_label</cite> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datasets</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">DatasetType</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetV2</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code>)]) – List of numpy, pytorch or tensorflow datasets.</p></li>
<li><p><strong>labels_in</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Array containing ‘normal’ labels.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">DatasetType</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetV2</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code>), <code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">DatasetType</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetV2</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code>)]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of split datasets
<cite>((dataset_in, dataset_out), …, (dataset_in, dataset_out))</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.supervised.split_on_label">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.supervised.</span></span><span class="sig-name descname"><span class="pre">split_on_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.supervised.split_on_label" title="Permalink to this definition"></a></dt>
<dd><p>Allows to split a dataset in in-dataset and out-dataset according to the
given labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">DatasetType</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetV2</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code>)) – A numpy, pytorch or tensorflow dataset.</p></li>
<li><p><strong>labels_in</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Array containing ‘normal’ labels.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">DatasetType</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetV2</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code>), <code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">DatasetType</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetV2</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code>)]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple of split datasets (<cite>dataset_in</cite>, <cite>dataset_out</cite>), where <cite>dataset_in</cite>
is the subset of samples whose labels are in <cite>labels_in</cite> and <cite>dataset_out</cite>
the remaining part of the dataset.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deel.datasets.utils.tensorflow_utils">
<span id="deel-datasets-utils-tensorflow-utils-module"></span><h2>deel.datasets.utils.tensorflow_utils module<a class="headerlink" href="#module-deel.datasets.utils.tensorflow_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.tensorflow_utils.tf_split_on_label">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.tensorflow_utils.</span></span><span class="sig-name descname"><span class="pre">tf_split_on_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.tensorflow_utils.tf_split_on_label" title="Permalink to this definition"></a></dt>
<dd><p>Allows to split a tensoflow dataset in in-dataset and
out-dataset according to labels_in
:type dataset: <code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetV2</span></code>
:param dataset: a tensoflow dataset
:type labels_in: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]
:param labels_in: array of ‘normal’ labels</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetV2</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetV2</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple of split datasets (dataset_in, dataset_out),</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deel.datasets.utils.torch_utils">
<span id="deel-datasets-utils-torch-utils-module"></span><h2>deel.datasets.utils.torch_utils module<a class="headerlink" href="#module-deel.datasets.utils.torch_utils" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deel.datasets.utils.torch_utils.ImageDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">ImageDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.torch_utils.ImageDataset" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="deel.datasets.utils.torch_utils.ImageDataset.loader">
<span class="sig-name descname"><span class="pre">loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.torch_utils.ImageDataset.loader" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deel.datasets.utils.torch_utils.OptionalToTensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">OptionalToTensor</span></span><a class="headerlink" href="#deel.datasets.utils.torch_utils.OptionalToTensor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Optional call to ToTensor() if the object is not already a tensor.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.torch_utils.torch_split_on_label">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">torch_split_on_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.torch_utils.torch_split_on_label" title="Permalink to this definition"></a></dt>
<dd><p>Allows to split a torch dataset in in-dataset and out-dataset according to labels_in
:type dataset: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code>
:param dataset: a torch dataset
:type labels_in: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]
:param labels_in: array of ‘normal’ labels</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple of split datasets (dataset_in, dataset_out),</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deel.datasets.utils.unsupervised">
<span id="deel-datasets-utils-unsupervised-module"></span><h2>deel.datasets.utils.unsupervised module<a class="headerlink" href="#module-deel.datasets.utils.unsupervised" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.unsupervised.load_hierarchical_python_image_dataset">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.unsupervised.</span></span><span class="sig-name descname"><span class="pre">load_hierarchical_python_image_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispatch_fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.unsupervised.load_hierarchical_python_image_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Walk the given folder applying the given function to
find to which dataset and class each file should be associated
to.</p>
<p>The function should returns a list of parts. The number of
parts can be different for each file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – The folder to look for files.</p></li>
<li><p><strong>dispatch_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]]) – A function that should return a list of str
representing the dataset (e.g, <cite>[“train”, “a”]</cite>) to represent
the dataset <cite>train/a</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary mapping dataset hierarchy to list of paths (a dictionary
of dictionary, indexed by string, whose leaves are list of paths).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.unsupervised.load_hierarchical_pytorch_image_dataset">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.unsupervised.</span></span><span class="sig-name descname"><span class="pre">load_hierarchical_pytorch_image_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispatch_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.unsupervised.load_hierarchical_pytorch_image_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Creates a pytorch image dataset from the given folder and
parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – The folder containing the dataset. The folder should contain,
for each classes, a subfolder with only images inside.</p></li>
<li><p><strong>dispatch_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]]) – A function that should return a list of str
representing the dataset (e.g, <cite>[“train”, “a”]</cite>) to represent
the dataset <cite>train/a</cite>.</p></li>
<li><p><strong>image_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – The size of the image, or None to not resize images.</p></li>
<li><p><strong>transform</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code>]]) – Transformation to apply to the image before the conversion
to a torch tensor via <cite>ToTensor()</cite>. If <cite>image_size</cite> is not None, the
resize transform will be applied before these, if you want to do the
opposite, simply pass <cite>None</cite> as <cite>image_size</cite> and add the resize
transformation manually.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple containing two or three datasets corresponding to training, validation
and testing dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.unsupervised.load_numpy_image_dataset">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.unsupervised.</span></span><span class="sig-name descname"><span class="pre">load_numpy_image_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_split=0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.unsupervised.load_numpy_image_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Creates a numpy image dataset from the given folder and
parameters.</p>
<p>The image dataset are 4-dimensional (N, H, W, C) numpy array where (H, W)
is the image size, C the number of channels. The arrays contain <cite>np.uint8</cite>
values between 0 and 255.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – The folder containing the dataset. The folder should contain,
for each classes, a subfolder with only images inside.</p></li>
<li><p><strong>image_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – The size of the image, or None to not resize images. <cite>None</cite>
is only supported if all the images already have the same size.</p></li>
<li><p><strong>train_split</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – One or two float values. If a single value is specified,
two datasets will be returned, one for training (using a percentage
<cite>train_split</cite> of data) and one for testing. If two values are specified,
three datasets will be returned: a training dataset, a validation
dataset and a testing dataset.</p></li>
<li><p><strong>shuffle</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – If True, shuffle images before spliting with the default seed.
If an int is given, use it as the seed for shuffling. If False, do not
shuffle.
False otherwise.</p></li>
<li><p><strong>filter_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – A function to filter out images. This function should take
a string (name of the file) and a path to the file and returns True
if the image should be included, False if it should be excluded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple containing two or three numpy arrays corresponding to training,
validation and testing datasets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.unsupervised.load_python_image_dataset">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.unsupervised.</span></span><span class="sig-name descname"><span class="pre">load_python_image_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.unsupervised.load_python_image_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Load a python “dataset” from the given folder. This methods
returns a list of paths from the given folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – The folder containing the dataset. The folder should contain,
for each class, a subfolder with only images inside.</p></li>
<li><p><strong>shuffle</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – If True, shuffle images with the default seed. If an int is given,
use it as the seed for shuffling. If False, do not shuffle. Shuffle is done
using the standard <cite>random.shuffle</cite> module
False otherwise.</p></li>
<li><p><strong>filter_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – A function to filter out images. This function should take
a string (name of the file) and a path to the file and returns True
if the image should be included, False if it should be excluded.</p></li>
</ul>
</dd>
</dl>
<p>Returns: A 3-tuple <cite>(paths, labels, classes)</cite> where <cite>paths</cite> is a list of
paths, <cite>labels</cite> is a list of labels (integers) and classes is a dictionary
from labels to names.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.unsupervised.load_pytorch_image_dataset">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.unsupervised.</span></span><span class="sig-name descname"><span class="pre">load_pytorch_image_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_split=0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.unsupervised.load_pytorch_image_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Creates a pytorch image dataset from the given folder and
parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – The folder containing the dataset. The folder should contain,
for each classes, a subfolder with only images inside.</p></li>
<li><p><strong>image_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – The size of the image, or None to not resize images.</p></li>
<li><p><strong>train_split</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – One or two float values. If a single value is specified,
two datasets will be returned, one for training (using a percentage
<cite>train_split</cite> of data) and one for testing. If two values are specified,
three datasets will be returned: a training dataset, a validation
dataset and a testing dataset.</p></li>
<li><p><strong>shuffle</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – If True, shuffle images before spliting with the default seed.
If an int is given, use it as the seed for shuffling. If False, do not
shuffle.</p></li>
<li><p><strong>filter_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – A function to filter out images. This function should take
a string (name of the file) and a path to the file and returns True
if the image should be included, False if it should be excluded.</p></li>
<li><p><strong>transform</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code>]]) – Transformation to apply to the image before the conversion
to a torch tensor via <cite>ToTensor()</cite>. If <cite>image_size</cite> is not None, the
resize transform will be applied before these, if you want to do the
opposite, simply pass <cite>None</cite> as <cite>image_size</cite> and add the resize
transformation manually.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple containing two or three datasets corresponding to training, validation
and testing datasets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deel.datasets.utils.unsupervised.load_tensorflow_image_dataset">
<span class="sig-prename descclassname"><span class="pre">deel.datasets.utils.unsupervised.</span></span><span class="sig-name descname"><span class="pre">load_tensorflow_image_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_split=0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_fn=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deel.datasets.utils.unsupervised.load_tensorflow_image_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Creates a tensorflow image dataset from the given folder and
parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – The folder containing the dataset. The folder should contain,
for each classes, a subfolder with only images inside.</p></li>
<li><p><strong>image_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – The size of the image, or None to not resize images.</p></li>
<li><p><strong>train_split</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – One or two float values. If a single value is specified,
two datasets will be returned, one for training (using a percentage
<cite>train_split</cite> of data) and one for testing. If two values are specified,
three datasets will be returned: a training dataset, a validation
dataset and a testing dataset.</p></li>
<li><p><strong>shuffle</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – If True, shuffle images before spliting with the default seed.
If an int is given, use it as the seed for shuffling. If False, do not
shuffle.
False otherwise.</p></li>
<li><p><strong>filter_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – A function to filter out images. This function should take
a string (name of the file) and a path to the file and returns True
if the image should be included, False if it should be excluded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple containing two or three datasets corresponding to training, validation
and testing datasets.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="deel.datasets.providers.html" class="btn btn-neutral float-left" title="deel.datasets.providers package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Mikaël Capelle, Justin Plakoo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>